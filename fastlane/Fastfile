# If you want to automatically update fastlane if a new version is available:
# update_fastlane

# This is the minimum version number required.
# Update this, if you use features of a newer version
fastlane_version "1.102.0"

import '../Shared/Conf/Scripts/fastlane.rb'

AWLProjectName = "CARingBuffer.xcodeproj"
AWLProjectRelativeFilePath = "#{AWLProjectName}"

desc "CI: Builds and run Swift tests."
lane :ci do
  XcodeBuildRelease("Developer: Analyze Performance", "Demo: CAPlayThrough")
  XcodeMacOSTest("Logic Tests: Swift")
  ValidateSources()
end

desc "Manual: Increment version number."
desc "Usually used when repository is on standard Git-Flow release branch."
lane :bump do
  ensure_git_status_clean
  Bump(AWLProjectRelativeFilePath)
end

desc "Manual: Cleans project."
lane :clean do
  XcodeClean("Developer: Build Everything")
end

desc "Manual: Builds project."
lane :build do
  XcodeBuild("Developer: Build Everything")
  ValidateSources()
end

desc "Manual: Runs all the tests (C++ and Swift)."
lane :test do
  XcodeMacOSTest("Logic Tests: Swift", "Logic Tests: C++")
  ValidateSources()
end

desc "Service: Update Fastlane and other Tools."
lane :update do
  SelfUpdate()
end

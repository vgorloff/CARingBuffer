# If you want to automatically update fastlane if a new version is available:
# update_fastlane

# This is the minimum version number required.
# Update this, if you use features of a newer version
fastlane_version "1.95.0"

import '../Shared/Conf/Scripts/fastlane.rb'

AWLProjectName = "CARingBuffer.xcodeproj"
AWLProjectRelativeFilePath = "#{AWLProjectName}"

desc "Runs all the tests (C++ and Swift)."
lane :test do
  XcodeMacOSTest("Logic Tests: Swift", "Logic Tests: C++")
end

desc "Builds project."
lane :build do
  XcodeBuild("CARBMeasure", "CAPlayThrough")
end

desc "Builds when under CI (i.e. Travis)."
lane :ci do
  XcodeBuildRelease("CARBMeasure", "CAPlayThrough")
  XcodeMacOSTest("Logic Tests: Swift")
end

desc "Increment version number."
desc "Usually should be runned after finishing release in Git Flow."
lane :bump do
  awl_branchName = git_branch
  puts awl_branchName
  ensure_git_status_clean
  Bump(AWLProjectRelativeFilePath)
end

desc "Cleans project."
lane :clean do
  XcodeClean("CAPlayThrough", "CARBMeasure", "Logic Tests: Swift", "Logic Tests: C++")
end
